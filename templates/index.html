<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> MYSC 투자심사보고서 분석 플랫폼</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        :root {
            /* Professional Color System */
            --bg-primary: #0a0b0f;
            --bg-secondary: #151621;
            --bg-tertiary: #1e1f2e;
            --bg-elevated: #252641;
            --bg-glass: rgba(37, 38, 65, 0.8);
            --bg-overlay: rgba(10, 11, 15, 0.95);
            
            /* Text Colors */
            --text-primary: #ffffff;
            --text-secondary: #c9d1d9;
            --text-tertiary: #8b949e;
            --text-muted: #6e7681;
            --text-accent: #58a6ff;
            
            /* Brand Colors */
            --primary: #6f42c1;
            --primary-light: #8957e5;
            --primary-dark: #553c9a;
            --secondary: #0969da;
            --accent: #7c3aed;
            
            /* Status Colors */
            --success: #238636;
            --success-bg: rgba(35, 134, 54, 0.1);
            --warning: #d1242f;
            --warning-bg: rgba(209, 36, 47, 0.1);
            --info: #0969da;
            --info-bg: rgba(9, 105, 218, 0.1);
            
            /* Borders */
            --border-primary: rgba(255, 255, 255, 0.1);
            --border-secondary: rgba(255, 255, 255, 0.05);
            --border-accent: rgba(111, 66, 193, 0.3);
            --border-focus: rgba(88, 166, 255, 0.4);
            
            /* Shadows */
            --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1), 0 10px 10px rgba(0, 0, 0, 0.04);
            --shadow-glass: 0 8px 32px rgba(111, 66, 193, 0.15);
            --shadow-accent: 0 0 0 3px var(--border-focus);
            
            /* Spacing System (8px grid) */
            --space-1: 0.25rem;  /* 4px */
            --space-2: 0.5rem;   /* 8px */
            --space-3: 0.75rem;  /* 12px */
            --space-4: 1rem;     /* 16px */
            --space-5: 1.25rem;  /* 20px */
            --space-6: 1.5rem;   /* 24px */
            --space-8: 2rem;     /* 32px */
            --space-10: 2.5rem;  /* 40px */
            --space-12: 3rem;    /* 48px */
            --space-16: 4rem;    /* 64px */
            --space-20: 5rem;    /* 80px */
            
            /* Border Radius */
            --radius-xs: 0.125rem; /* 2px */
            --radius-sm: 0.25rem;  /* 4px */
            --radius-md: 0.5rem;   /* 8px */
            --radius-lg: 0.75rem;  /* 12px */
            --radius-xl: 1rem;     /* 16px */
            --radius-2xl: 1.5rem;  /* 24px */
            
            /* Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(111, 66, 193, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(124, 58, 237, 0.03) 0%, transparent 50%);
            color: var(--text-primary);
            line-height: 1.6;
            font-feature-settings: 'cv11', 'ss01';
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
        }

        /* Header */
        .header {
            position: sticky;
            top: 0;
            z-index: 50;
            background: var(--bg-overlay);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-primary);
            padding: var(--space-4) 0;
        }

        .header-content {
            max-width: 1440px;
            margin: 0 auto;
            padding: 0 var(--space-6);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .brand-logo {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .brand-text {
            font-size: 1.25rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--text-primary), var(--text-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-nav {
            display: flex;
            align-items: center;
            gap: var(--space-6);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-md);
            transition: var(--transition-fast);
        }

        .nav-item:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        .nav-item.active {
            color: var(--text-primary);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-accent);
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-3);
            background: var(--success-bg);
            border: 1px solid var(--success);
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--success);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Main Layout */
        .app-container {
            max-width: 1440px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: var(--space-8);
            padding: var(--space-8) var(--space-6);
            min-height: calc(100vh - 80px);
        }

        .section-content {
            display: none;
        }

        .section-content.active {
            display: block;
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: var(--space-6);
        }

        .sidebar-section {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-2xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-glass);
        }

        .sidebar-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-4);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .history-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            border-radius: var(--radius-lg);
            transition: var(--transition-fast);
            cursor: pointer;
        }

        .history-item:hover {
            background: var(--bg-tertiary);
        }

        .history-icon {
            width: 32px;
            height: 32px;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .history-details {
            flex: 1;
            min-width: 0;
        }

        .history-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .history-date {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .quick-action {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-4);
            background: var(--bg-secondary);
            border: 1px solid var(--border-secondary);
            border-radius: var(--radius-xl);
            text-decoration: none;
            color: var(--text-secondary);
            transition: var(--transition-fast);
            font-weight: 500;
        }

        .quick-action:hover {
            background: var(--bg-tertiary);
            border-color: var(--border-primary);
            color: var(--text-primary);
            transform: translateY(-1px);
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: var(--space-8);
        }

        .page-header {
            text-align: center;
            padding: var(--space-12) 0;
        }

        .page-title {
            font-size: clamp(2.5rem, 4vw, 3.5rem);
            font-weight: 800;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-4);
            line-height: 1.1;
            letter-spacing: -0.02em;
        }

        .page-subtitle {
            font-size: 1.25rem;
            color: var(--text-secondary);
            font-weight: 400;
            max-width: 600px;
            margin: 0 auto;
        }

        .analysis-card {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-2xl);
            padding: var(--space-8);
            box-shadow: var(--shadow-glass);
            position: relative;
            overflow: hidden;
        }

        .analysis-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-accent), transparent);
        }

        .form-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-8);
            margin-bottom: var(--space-8);
        }

        .upload-area {
            grid-column: 1 / -1;
            border: 2px dashed var(--border-primary);
            border-radius: var(--radius-xl);
            padding: var(--space-12) var(--space-8);
            text-align: center;
            background: var(--bg-secondary);
            transition: var(--transition-base);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .upload-area::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(111, 66, 193, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .upload-area:hover {
            border-color: var(--border-accent);
            background: var(--bg-tertiary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .upload-area:hover::before {
            left: 100%;
        }

        .upload-area.dragover {
            border-color: var(--success);
            background: var(--success-bg);
            box-shadow: 0 0 0 2px var(--success);
        }

        .upload-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-4);
        }

        .upload-icon {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .upload-text {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-2);
        }

        .upload-subtext {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .supported-formats {
            display: flex;
            gap: var(--space-2);
            margin-top: var(--space-4);
        }

        .format-badge {
            padding: var(--space-1) var(--space-2);
            background: var(--bg-elevated);
            border: 1px solid var(--border-secondary);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-tertiary);
            text-transform: uppercase;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-weight: 500;
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .form-label.required::after {
            content: '*';
            color: var(--warning);
            margin-left: var(--space-1);
        }

        .form-input {
            width: 100%;
            padding: var(--space-4) var(--space-4);
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-lg);
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
            transition: var(--transition-fast);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--bg-tertiary);
            box-shadow: var(--shadow-accent);
        }

        .form-help {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: var(--space-1);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: var(--space-4) var(--space-8);
            font-size: 1rem;
            font-weight: 600;
            font-family: inherit;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: var(--transition-base);
            position: relative;
            overflow: hidden;
            text-transform: none;
            letter-spacing: -0.01em;
            box-shadow: var(--shadow-md);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Progress Steps */
        .progress-container {
            display: none;
            grid-column: 1 / -1;
            padding: var(--space-8);
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-xl);
            margin-bottom: var(--space-8);
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--space-6);
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }

        .progress-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            right: -50%;
            width: 100%;
            height: 2px;
            background: var(--border-secondary);
            z-index: -1;
        }

        .progress-step.active:not(:last-child)::after {
            background: var(--primary);
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-elevated);
            border: 2px solid var(--border-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: var(--space-2);
            transition: var(--transition-fast);
            color: var(--text-muted);
        }

        .progress-step.active .step-circle {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .progress-step.completed .step-circle {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .step-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-muted);
            text-align: center;
        }

        .progress-step.active .step-label {
            color: var(--text-primary);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-elevated);
            border-radius: var(--radius-sm);
            overflow: hidden;
            margin-bottom: var(--space-4);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            width: 0%;
            transition: width 0.5s ease;
            border-radius: var(--radius-sm);
        }

        .progress-text {
            text-align: center;
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* File Upload States */
        .file-validation {
            display: none;
            grid-column: 1 / -1;
            background: var(--info-bg);
            border: 1px solid var(--info);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            margin-bottom: var(--space-6);
        }

        .validation-items {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .validation-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            font-size: 0.875rem;
        }

        .validation-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-elevated);
            color: var(--text-muted);
            flex-shrink: 0;
        }

        .validation-item.success .validation-icon {
            background: var(--success);
            color: white;
        }

        .validation-item.error .validation-icon {
            background: var(--warning);
            color: white;
        }

        /* Results Section */
        .results-container {
            display: none;
            grid-column: 1 / -1;
        }

        .results-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-8);
            padding-bottom: var(--space-6);
            border-bottom: 1px solid var(--border-secondary);
        }

        .results-title {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .results-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--success), #10b981);
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            box-shadow: var(--shadow-md);
        }

        .results-title-text {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .results-actions {
            display: flex;
            gap: var(--space-3);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 1px solid var(--border-primary);
            padding: var(--space-3) var(--space-4);
            font-size: 0.875rem;
            font-weight: 500;
            font-family: inherit;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .btn-secondary:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-color: var(--border-accent);
        }

        .executive-summary {
            background: var(--success-bg);
            border: 1px solid var(--success);
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            margin-bottom: var(--space-8);
        }

        .summary-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--success);
            margin-bottom: var(--space-4);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .summary-content {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .results-tabs {
            display: flex;
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: var(--space-1);
            margin-bottom: var(--space-8);
            overflow-x: auto;
        }

        .tab-button {
            flex: 1;
            padding: var(--space-3) var(--space-4);
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 0.875rem;
            font-weight: 500;
            font-family: inherit;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: var(--transition-fast);
            white-space: nowrap;
        }

        .tab-button.active {
            background: var(--primary);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .tab-content {
            display: none;
            background: var(--bg-secondary);
            border: 1px solid var(--border-secondary);
            border-radius: var(--radius-xl);
            padding: var(--space-8);
            max-height: 600px;
            overflow-y: auto;
        }

        .tab-content.active {
            display: block;
        }

        .report-content {
            color: var(--text-secondary);
            line-height: 1.8;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
        }

        /* Custom Scrollbar */
        .tab-content::-webkit-scrollbar {
            width: 6px;
        }

        .tab-content::-webkit-scrollbar-track {
            background: var(--bg-elevated);
            border-radius: 3px;
        }

        .tab-content::-webkit-scrollbar-thumb {
            background: var(--border-primary);
            border-radius: 3px;
        }

        .tab-content::-webkit-scrollbar-thumb:hover {
            background: var(--border-accent);
        }

        /* Error Handling */
        .error-message {
            background: var(--warning-bg);
            color: var(--warning);
            border: 1px solid var(--warning);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            margin-top: var(--space-4);
            display: flex;
            align-items: start;
            gap: var(--space-3);
        }

        .error-icon {
            flex-shrink: 0;
            margin-top: var(--space-1);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .app-container {
                grid-template-columns: 280px 1fr;
                gap: var(--space-6);
                padding: var(--space-6) var(--space-4);
            }
        }

        @media (max-width: 768px) {
            .header-content {
                padding: 0 var(--space-4);
            }

            .header-nav {
                gap: var(--space-4);
            }

            .nav-item span {
                display: none;
            }

            .app-container {
                grid-template-columns: 1fr;
                gap: var(--space-6);
                padding: var(--space-4);
            }

            .sidebar {
                order: 2;
            }

            .main-content {
                order: 1;
            }

            .form-section {
                grid-template-columns: 1fr;
                gap: var(--space-6);
            }

            .results-header {
                flex-direction: column;
                gap: var(--space-4);
                align-items: flex-start;
            }

            .results-actions {
                width: 100%;
                justify-content: flex-start;
            }

            .results-tabs {
                overflow-x: scroll;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }

            .results-tabs::-webkit-scrollbar {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .page-title {
                font-size: 2rem;
            }

            .analysis-card {
                padding: var(--space-6);
            }

            .upload-area {
                padding: var(--space-8) var(--space-4);
            }

            .sidebar-section {
                padding: var(--space-4);
            }

            .supported-formats {
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .slide-in {
            animation: slideIn 0.3s ease-out;
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Focus states for accessibility */
        .upload-area:focus-within,
        .form-input:focus,
        .btn-primary:focus,
        .btn-secondary:focus,
        .tab-button:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="brand">
                <div class="brand-logo">M</div>
                <div class="brand-text">MYSC AI Agent</div>
            </div>
            <nav class="header-nav">
                <a href="#" class="nav-item active" data-section="investment">
                    <i data-lucide="trending-up" style="width: 16px; height: 16px;"></i>
                    <span>투자</span>
                </a>
                <a href="#" class="nav-item" data-section="consulting">
                    <i data-lucide="users" style="width: 16px; height: 16px;"></i>
                    <span>컨설팅</span>
                </a>
                <a href="#" class="nav-item" data-section="impact">
                    <i data-lucide="heart" style="width: 16px; height: 16px;"></i>
                    <span>임팩트 진단</span>
                </a>
                <a href="#" class="nav-item" data-section="settings">
                    <i data-lucide="settings" style="width: 16px; height: 16px;"></i>
                    <span>설정</span>
                </a>
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span>서비스 정상</span>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main App Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <h3 class="sidebar-title">
                    <i data-lucide="activity" style="width: 16px; height: 16px;"></i>
                    API 사용량
                </h3>
                
                <!-- API 상태 표시 -->
                <div class="api-status-card" style="background: var(--success-bg); border: 1px solid var(--success); border-radius: var(--radius-lg); padding: var(--space-4); margin-bottom: var(--space-4);">
                    <div style="display: flex; align-items: center; gap: var(--space-2); margin-bottom: var(--space-2);">
                        <div class="status-dot" style="width: 8px; height: 8px; background: var(--success); border-radius: 50%;"></div>
                        <span style="font-size: 0.875rem; font-weight: 500; color: var(--success);">API 연결됨</span>
                    </div>
                    <p style="font-size: 0.75rem; color: var(--text-secondary); margin: 0;">Gemini Pro</p>
                </div>

                <!-- 사용량 통계 -->
                <div class="usage-stats">
                    <!-- 오늘 사용량 -->
                    <div class="usage-item" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-lg); transition: var(--transition-fast); margin-bottom: var(--space-2);">
                        <div class="usage-icon" style="width: 32px; height: 32px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <i data-lucide="zap" style="width: 16px; height: 16px; color: white;"></i>
                        </div>
                        <div class="usage-details" style="flex: 1; min-width: 0;">
                            <div class="usage-label" style="font-size: 0.875rem; font-weight: 500; color: var(--text-primary);">오늘 사용량</div>
                            <div class="usage-value" style="font-size: 0.75rem; color: var(--text-muted);" id="todayUsage">0 토큰</div>
                        </div>
                    </div>

                    <!-- 이번 달 사용량 -->
                    <div class="usage-item" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-lg); transition: var(--transition-fast); margin-bottom: var(--space-2);">
                        <div class="usage-icon" style="width: 32px; height: 32px; background: linear-gradient(135deg, var(--info), var(--secondary)); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <i data-lucide="calendar" style="width: 16px; height: 16px; color: white;"></i>
                        </div>
                        <div class="usage-details" style="flex: 1; min-width: 0;">
                            <div class="usage-label" style="font-size: 0.875rem; font-weight: 500; color: var(--text-primary);">이번 달</div>
                            <div class="usage-value" style="font-size: 0.75rem; color: var(--text-muted);" id="monthlyUsage">0 토큰</div>
                        </div>
                    </div>

                    <!-- 총 분석 횟수 -->
                    <div class="usage-item" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-lg); transition: var(--transition-fast); margin-bottom: var(--space-4);">
                        <div class="usage-icon" style="width: 32px; height: 32px; background: linear-gradient(135deg, var(--accent-success), #10b981); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <i data-lucide="file-check" style="width: 16px; height: 16px; color: white;"></i>
                        </div>
                        <div class="usage-details" style="flex: 1; min-width: 0;">
                            <div class="usage-label" style="font-size: 0.875rem; font-weight: 500; color: var(--text-primary);">총 분석</div>
                            <div class="usage-value" style="font-size: 0.75rem; color: var(--text-muted);" id="totalAnalyses">0회</div>
                        </div>
                    </div>
                </div>

                <!-- 사용량 차트 (간단한 프로그레스 바) -->
                <div class="usage-chart" style="background: var(--bg-tertiary); border-radius: var(--radius-lg); padding: var(--space-4);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-2);">
                        <span style="font-size: 0.75rem; color: var(--text-secondary);">월간 한도</span>
                        <span style="font-size: 0.75rem; color: var(--text-secondary);" id="usagePercent">0%</span>
                    </div>
                    <div class="progress-bar" style="width: 100%; height: 6px; background: var(--bg-elevated); border-radius: var(--radius-sm); overflow: hidden;">
                        <div class="progress-fill" id="usageProgress" style="height: 100%; background: linear-gradient(90deg, var(--success), var(--primary)); width: 0%; transition: width 0.5s ease; border-radius: var(--radius-sm);"></div>
                    </div>
                    <div style="font-size: 0.6875rem; color: var(--text-muted); margin-top: var(--space-1); text-align: center;">
                        무료 한도: 1,500 RPD
                    </div>
                </div>
            </div>

            <div class="sidebar-section">
                <h3 class="sidebar-title">
                    <i data-lucide="zap" style="width: 16px; height: 16px;"></i>
                    빠른 작업
                </h3>
                <a href="#" class="quick-action">
                    <i data-lucide="template" style="width: 20px; height: 20px;"></i>
                    <span>템플릿 사용</span>
                </a>
                <a href="#" class="quick-action">
                    <i data-lucide="upload" style="width: 20px; height: 20px;"></i>
                    <span>일괄 업로드</span>
                </a>
                <a href="#" class="quick-action">
                    <i data-lucide="download" style="width: 20px; height: 20px;"></i>
                    <span>보고서 내보내기</span>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Investment Section -->
            <div class="section-content active" id="investment-section">
                <div class="page-header">
                    <h1 class="page-title">전문 투자심사보고서 분석</h1>
                    <p class="page-subtitle">AI 기반 투자심사보고서 자동 생성으로 더 빠르고 정확한 투자 의사결정을 지원합니다</p>
                </div>

                <div class="analysis-card" style="width: 100%;">
                <form id="analysisForm" enctype="multipart/form-data">
                    <!-- Upload Section -->
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-content">
                            <div class="upload-icon">
                                <i data-lucide="upload" style="width: 32px; height: 32px;"></i>
                            </div>
                            <div class="upload-text">IR 자료를 드래그하여 업로드하세요</div>
                            <div class="upload-subtext">또는 클릭하여 파일을 선택하세요</div>
                            <div class="supported-formats">
                                <span class="format-badge">PDF</span>
                                <span class="format-badge">Excel</span>
                                <span class="format-badge">Word</span>
                            </div>
                        </div>
                        <input type="file" id="fileInput" accept=".pdf,.xlsx,.xls,.docx,.doc" style="display: none;">
                    </div>

                    <!-- File Validation -->
                    <div class="file-validation" id="fileValidation">
                        <div class="validation-items">
                            <div class="validation-item" id="formatValidation">
                                <div class="validation-icon">
                                    <i data-lucide="file-check" style="width: 12px; height: 12px;"></i>
                                </div>
                                <span>파일 형식 검증</span>
                            </div>
                            <div class="validation-item" id="sizeValidation">
                                <div class="validation-icon">
                                    <i data-lucide="hard-drive" style="width: 12px; height: 12px;"></i>
                                </div>
                                <span>파일 크기 확인 (최대 50MB)</span>
                            </div>
                        </div>
                    </div>

                    <!-- Progress Steps -->
                    <div class="progress-container" id="progressContainer">
                        <div class="progress-steps">
                            <div class="progress-step" id="step1">
                                <div class="step-circle">
                                    <i data-lucide="upload" style="width: 20px; height: 20px;"></i>
                                </div>
                                <div class="step-label">업로드</div>
                            </div>
                            <div class="progress-step" id="step2">
                                <div class="step-circle">
                                    <i data-lucide="cpu" style="width: 20px; height: 20px;"></i>
                                </div>
                                <div class="step-label">처리</div>
                            </div>
                            <div class="progress-step" id="step3">
                                <div class="step-circle">
                                    <i data-lucide="brain" style="width: 20px; height: 20px;"></i>
                                </div>
                                <div class="step-label">분석</div>
                            </div>
                            <div class="progress-step" id="step4">
                                <div class="step-circle">
                                    <i data-lucide="check" style="width: 20px; height: 20px;"></i>
                                </div>
                                <div class="step-label">완료</div>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">분석을 준비하고 있습니다...</div>
                    </div>

                    <!-- Form Fields -->
                    <div class="form-section">
                        <div class="form-group">
                            <label for="companyName" class="form-label required">
                                <i data-lucide="building" style="width: 16px; height: 16px;"></i>
                                회사명
                            </label>
                            <input 
                                type="text" 
                                id="companyName" 
                                class="form-input" 
                                placeholder="예: 삼성전자" 
                                required
                            >
                            <div class="form-help">분석할 기업의 정확한 명칭을 입력해주세요</div>
                        </div>

                        <div class="form-group">
                            <label for="irUrl" class="form-label">
                                <i data-lucide="link" style="width: 16px; height: 16px;"></i>
                                IR 자료 URL (선택사항)
                            </label>
                            <input 
                                type="url" 
                                id="irUrl" 
                                class="form-input" 
                                placeholder="https://example.com/ir-report.pdf"
                            >
                            <div class="form-help">온라인 IR 자료 링크가 있는 경우 입력해주세요</div>
                        </div>
                    </div>

                    <button type="submit" class="btn-primary" id="analyzeBtn">
                        <i data-lucide="sparkles" style="width: 20px; height: 20px; margin-right: 8px;"></i>
                        투자심사보고서 생성하기
                    </button>
                </form>

                <!-- Results Section -->
                <div class="results-container" id="resultsContainer">
                    <div class="results-header">
                        <div class="results-title">
                            <div class="results-icon">
                                <i data-lucide="check-circle" style="width: 24px; height: 24px;"></i>
                            </div>
                            <div class="results-title-text" id="resultsTitle">투자심사보고서 완성</div>
                        </div>
                        <div class="results-actions">
                            <button class="btn-secondary" id="exportPdf">
                                <i data-lucide="file-text" style="width: 16px; height: 16px;"></i>
                                PDF 내보내기
                            </button>
                            <button class="btn-secondary" id="exportWord">
                                <i data-lucide="file-type" style="width: 16px; height: 16px;"></i>
                                Word 내보내기
                            </button>
                            <button class="btn-secondary" id="shareReport">
                                <i data-lucide="share" style="width: 16px; height: 16px;"></i>
                                공유하기
                            </button>
                        </div>
                    </div>

                    <!-- Executive Summary -->
                    <div class="executive-summary">
                        <div class="summary-title">
                            <i data-lucide="lightbulb" style="width: 20px; height: 20px;"></i>
                            핵심 요약
                        </div>
                        <div class="summary-content" id="executiveSummary">
                            분석이 완료되면 여기에 핵심 요약이 표시됩니다.
                        </div>
                    </div>

                    <!-- Results Tabs -->
                    <div class="results-tabs">
                        <button class="tab-button active" data-tab="investment">투자 보고서</button>
                        <button class="tab-button" data-tab="financial">재무 분석</button>
                        <button class="tab-button" data-tab="risk">리스크 평가</button>
                        <button class="tab-button" data-tab="recommendations">권고사항</button>
                    </div>

                    <div class="tab-content active" id="tab-investment">
                        <div class="report-content" id="investmentReport">
                            투자 보고서 내용이 여기에 표시됩니다...
                        </div>
                    </div>

                    <div class="tab-content" id="tab-financial">
                        <div class="report-content" id="financialReport">
                            재무 분석 내용이 여기에 표시됩니다...
                        </div>
                    </div>

                    <div class="tab-content" id="tab-risk">
                        <div class="report-content" id="riskReport">
                            리스크 평가 내용이 여기에 표시됩니다...
                        </div>
                    </div>

                    <div class="tab-content" id="tab-recommendations">
                        <div class="report-content" id="recommendationsReport">
                            권고사항이 여기에 표시됩니다...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Consulting Section -->
            <div class="section-content" id="consulting-section">
                <div class="page-header">
                    <h1 class="page-title">컨설팅 서비스</h1>
                    <p class="page-subtitle">전문가 컨설팅을 통한 맞춤형 비즈니스 솔루션을 제공합니다</p>
                </div>

                <div class="analysis-card" style="width: 100%;">
                    <div style="text-align: center; padding: var(--space-16);">
                        <div style="width: 64px; height: 64px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-6);">
                            <i data-lucide="users" style="width: 32px; height: 32px; color: white;"></i>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-4);">컨설팅 서비스 준비 중</h3>
                        <p style="color: var(--text-secondary); margin-bottom: var(--space-6);">전문가와의 1:1 컨설팅 서비스를 준비하고 있습니다.</p>
                        <button class="btn-primary" disabled>
                            <i data-lucide="clock" style="width: 20px; height: 20px; margin-right: 8px;"></i>
                            서비스 준비 중
                        </button>
                    </div>
                </div>
            </div>

            <!-- Impact Assessment Section -->
            <div class="section-content" id="impact-section">
                <div class="page-header">
                    <h1 class="page-title">임팩트 진단</h1>
                    <p class="page-subtitle">사회적 임팩트를 측정하고 개선 방안을 제시합니다</p>
                </div>

                <div class="analysis-card" style="width: 100%;">
                    <div style="text-align: center; padding: var(--space-16);">
                        <div style="width: 64px; height: 64px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-6);">
                            <i data-lucide="heart" style="width: 32px; height: 32px; color: white;"></i>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-4);">임팩트 진단 도구 개발 중</h3>
                        <p style="color: var(--text-secondary); margin-bottom: var(--space-6);">사회적 임팩트 측정 및 진단 도구를 개발하고 있습니다.</p>
                        <button class="btn-primary" disabled>
                            <i data-lucide="clock" style="width: 20px; height: 20px; margin-right: 8px;"></i>
                            서비스 준비 중
                        </button>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div class="section-content" id="settings-section">
                <div class="page-header">
                    <h1 class="page-title">설정</h1>
                    <p class="page-subtitle">계정 및 서비스 설정을 관리합니다</p>
                </div>

                <div class="analysis-card" style="width: 100%;">
                    <div style="text-align: center; padding: var(--space-16);">
                        <div style="width: 64px; height: 64px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-6);">
                            <i data-lucide="settings" style="width: 32px; height: 32px; color: white;"></i>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-4);">설정 페이지 준비 중</h3>
                        <p style="color: var(--text-secondary); margin-bottom: var(--space-6);">사용자 설정 및 환경 설정 기능을 준비하고 있습니다.</p>
                        <button class="btn-primary" disabled>
                            <i data-lucide="clock" style="width: 20px; height: 20px; margin-right: 8px;"></i>
                            서비스 준비 중
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        class InvestmentAnalysisApp {
            constructor() {
                this.initializeElements();
                this.bindEvents();
                this.currentStep = 0;
                this.isAnalyzing = false;
            }

            initializeElements() {
                // Form elements
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.analysisForm = document.getElementById('analysisForm');
                this.analyzeBtn = document.getElementById('analyzeBtn');
                
                // Progress elements
                this.progressContainer = document.getElementById('progressContainer');
                this.progressFill = document.getElementById('progressFill');
                this.progressText = document.getElementById('progressText');
                
                // Validation elements
                this.fileValidation = document.getElementById('fileValidation');
                this.formatValidation = document.getElementById('formatValidation');
                this.sizeValidation = document.getElementById('sizeValidation');
                
                // Results elements
                this.resultsContainer = document.getElementById('resultsContainer');
                this.resultsTitle = document.getElementById('resultsTitle');
                this.executiveSummary = document.getElementById('executiveSummary');
                
                // Tab elements
                this.tabButtons = document.querySelectorAll('.tab-button');
                this.tabContents = document.querySelectorAll('.tab-content');
            }

            bindEvents() {
                // File upload events
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                this.uploadArea.addEventListener('dragover', this.handleDragOver.bind(this));
                this.uploadArea.addEventListener('dragleave', this.handleDragLeave.bind(this));
                this.uploadArea.addEventListener('drop', this.handleDrop.bind(this));
                this.fileInput.addEventListener('change', this.handleFileSelect.bind(this));
                
                // Form submission
                this.analysisForm.addEventListener('submit', this.handleFormSubmit.bind(this));
                
                // Tab switching
                this.tabButtons.forEach(button => {
                    button.addEventListener('click', this.handleTabSwitch.bind(this));
                });
                
                // Export buttons
                document.getElementById('exportPdf')?.addEventListener('click', () => this.handleExport('pdf'));
                document.getElementById('exportWord')?.addEventListener('click', () => this.handleExport('word'));
                document.getElementById('shareReport')?.addEventListener('click', this.handleShare.bind(this));
            }

            handleDragOver(e) {
                e.preventDefault();
                this.uploadArea.classList.add('dragover');
            }

            handleDragLeave(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
            }

            handleDrop(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    this.fileInput.files = files;
                    this.validateFile(files[0]);
                }
            }

            handleFileSelect(e) {
                if (e.target.files.length > 0) {
                    this.validateFile(e.target.files[0]);
                }
            }

            validateFile(file) {
                this.fileValidation.style.display = 'block';
                
                // Validate format
                const allowedTypes = ['.pdf', '.xlsx', '.xls', '.docx', '.doc'];
                const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
                const isValidFormat = allowedTypes.includes(fileExtension);
                
                this.updateValidationItem(this.formatValidation, isValidFormat, 
                    isValidFormat ? '파일 형식이 유효합니다' : '지원되지 않는 파일 형식입니다');
                
                // Validate size (50MB limit)
                const maxSize = 50 * 1024 * 1024; // 50MB
                const isValidSize = file.size <= maxSize;
                const sizeText = isValidSize ? 
                    `파일 크기: ${(file.size / 1024 / 1024).toFixed(2)}MB` : 
                    '파일이 너무 큽니다 (최대 50MB)';
                
                this.updateValidationItem(this.sizeValidation, isValidSize, sizeText);
                
                // Update upload area text
                if (isValidFormat && isValidSize) {
                    this.uploadArea.querySelector('.upload-text').textContent = file.name;
                    this.uploadArea.querySelector('.upload-subtext').textContent = 
                        `${(file.size / 1024 / 1024).toFixed(2)}MB - 분석 준비 완료`;
                }
            }

            updateValidationItem(element, isValid, text) {
                element.classList.toggle('success', isValid);
                element.classList.toggle('error', !isValid);
                element.querySelector('span:last-child').textContent = text;
                
                const icon = element.querySelector('.validation-icon i');
                icon.setAttribute('data-lucide', isValid ? 'check' : 'x');
                lucide.createIcons();
            }

            async handleFormSubmit(e) {
                e.preventDefault();
                
                if (this.isAnalyzing) return;
                
                const companyName = document.getElementById('companyName').value;
                const irUrl = document.getElementById('irUrl').value;
                const file = this.fileInput.files[0];
                
                if (!companyName) {
                    this.showError('회사명을 입력해주세요.');
                    return;
                }
                
                if (!file && !irUrl) {
                    this.showError('IR 자료 파일을 업로드하거나 URL을 입력해주세요.');
                    return;
                }
                
                await this.startAnalysis(companyName, file, irUrl);
            }

            async startAnalysis(companyName, file, irUrl) {
                this.isAnalyzing = true;
                this.showProgress();
                
                try {
                    let response;
                    
                    if (file) {
                        response = await this.uploadAndAnalyze(file, companyName);
                    } else {
                        response = await this.analyzeFromUrl(companyName, irUrl);
                    }
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        this.showResults(result);
                    } else {
                        this.showError(result.detail || '분석 중 오류가 발생했습니다.');
                    }
                } catch (error) {
                    console.error('Analysis error:', error);
                    this.showError('서버 연결에 실패했습니다. 잠시 후 다시 시도해주세요.');
                } finally {
                    this.isAnalyzing = false;
                }
            }

            async uploadAndAnalyze(file, companyName) {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('company_name', companyName);
                
                return fetch('/api/analyze-ir-file', {
                    method: 'POST',
                    body: formData
                });
            }

            async analyzeFromUrl(companyName, irUrl) {
                return fetch('/api/analyze-ir', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        company_name: companyName,
                        ir_url: irUrl,
                        analysis_type: 'investment_report'
                    })
                });
            }

            showProgress() {
                this.analysisForm.style.display = 'none';
                this.progressContainer.style.display = 'block';
                this.resultsContainer.style.display = 'none';
                
                this.simulateProgress();
            }

            simulateProgress() {
                const steps = [
                    { id: 'step1', text: '파일을 업로드하고 있습니다...', progress: 25 },
                    { id: 'step2', text: '문서를 처리하고 있습니다...', progress: 50 },
                    { id: 'step3', text: 'AI가 내용을 분석하고 있습니다...', progress: 75 },
                    { id: 'step4', text: '보고서를 생성하고 있습니다...', progress: 100 }
                ];
                
                let currentStepIndex = 0;
                
                const updateStep = () => {
                    if (currentStepIndex < steps.length) {
                        const step = steps[currentStepIndex];
                        
                        // Update progress bar
                        this.progressFill.style.width = step.progress + '%';
                        this.progressText.textContent = step.text;
                        
                        // Update step indicators
                        const stepElement = document.getElementById(step.id);
                        stepElement.classList.add('active');
                        
                        if (currentStepIndex > 0) {
                            const prevStep = document.getElementById(steps[currentStepIndex - 1].id);
                            prevStep.classList.remove('active');
                            prevStep.classList.add('completed');
                        }
                        
                        currentStepIndex++;
                        
                        if (currentStepIndex < steps.length) {
                            setTimeout(updateStep, 2000 + Math.random() * 3000);
                        }
                    }
                };
                
                setTimeout(updateStep, 500);
            }

            showResults(result) {
                this.progressContainer.style.display = 'none';
                this.resultsContainer.style.display = 'block';
                this.resultsContainer.classList.add('fade-in');
                
                this.resultsTitle.textContent = `${result.company_name} 투자심사보고서`;
                
                // Parse and display results
                const reportSections = this.parseReportSections(result.investment_report);
                
                this.executiveSummary.textContent = reportSections.summary || 
                    '이 보고서는 ' + result.company_name + '에 대한 종합적인 투자 분석을 제공합니다.';
                
                document.getElementById('investmentReport').textContent = reportSections.investment || result.investment_report;
                document.getElementById('financialReport').textContent = reportSections.financial || '재무 분석 데이터를 처리 중입니다...';
                document.getElementById('riskReport').textContent = reportSections.risk || '리스크 평가를 진행 중입니다...';
                document.getElementById('recommendationsReport').textContent = reportSections.recommendations || '권고사항을 작성 중입니다...';
                
                // Scroll to results
                this.resultsContainer.scrollIntoView({ behavior: 'smooth' });
            }

            parseReportSections(report) {
                // Simple parsing logic - in a real app, this would be more sophisticated
                const sections = {
                    summary: '',
                    investment: report,
                    financial: '',
                    risk: '',
                    recommendations: ''
                };
                
                // Try to extract sections based on common patterns
                const lines = report.split('\n');
                let currentSection = 'investment';
                
                lines.forEach(line => {
                    const lowerLine = line.toLowerCase();
                    if (lowerLine.includes('요약') || lowerLine.includes('summary')) {
                        currentSection = 'summary';
                    } else if (lowerLine.includes('재무') || lowerLine.includes('financial')) {
                        currentSection = 'financial';
                    } else if (lowerLine.includes('리스크') || lowerLine.includes('risk')) {
                        currentSection = 'risk';
                    } else if (lowerLine.includes('권고') || lowerLine.includes('recommendation')) {
                        currentSection = 'recommendations';
                    } else if (line.trim()) {
                        sections[currentSection] += line + '\n';
                    }
                });
                
                return sections;
            }

            handleTabSwitch(e) {
                const tabId = e.target.dataset.tab;
                
                // Update tab buttons
                this.tabButtons.forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                
                // Update tab contents
                this.tabContents.forEach(content => content.classList.remove('active'));
                document.getElementById(`tab-${tabId}`).classList.add('active');
            }

            handleExport(format) {
                // In a real app, this would trigger actual export functionality
                console.log(`Exporting as ${format}`);
                this.showMessage(`${format.toUpperCase()} 내보내기 기능은 개발 중입니다.`, 'info');
            }

            handleShare() {
                // In a real app, this would open share dialog
                console.log('Sharing report');
                this.showMessage('공유 기능은 개발 중입니다.', 'info');
            }

            showError(message) {
                this.progressContainer.style.display = 'none';
                this.analysisForm.style.display = 'block';
                
                const existingError = document.querySelector('.error-message');
                if (existingError) {
                    existingError.remove();
                }
                
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.innerHTML = `
                    <i data-lucide="alert-circle" class="error-icon" style="width: 20px; height: 20px;"></i>
                    <div>${message}</div>
                `;
                
                this.analysisForm.appendChild(errorDiv);
                lucide.createIcons();
                
                setTimeout(() => {
                    errorDiv.remove();
                }, 8000);
            }

            showMessage(message, type = 'info') {
                // Simple message display - in a real app, this would be a proper toast system
                console.log(`${type.toUpperCase()}: ${message}`);
            }
        }

        // API Usage Tracking
        class APIUsageTracker {
            constructor() {
                this.initializeStorage();
                this.updateDisplay();
            }

            initializeStorage() {
                if (!localStorage.getItem('apiUsage')) {
                    localStorage.setItem('apiUsage', JSON.stringify({
                        dailyUsage: {},
                        monthlyUsage: {},
                        totalAnalyses: 0,
                        lastReset: new Date().toDateString()
                    }));
                }
            }

            getUsageData() {
                return JSON.parse(localStorage.getItem('apiUsage'));
            }

            saveUsageData(data) {
                localStorage.setItem('apiUsage', JSON.stringify(data));
            }

            getCurrentDate() {
                return new Date().toDateString();
            }

            getCurrentMonth() {
                const date = new Date();
                return `${date.getFullYear()}-${date.getMonth() + 1}`;
            }

            recordUsage(tokensUsed = 1000) {
                const data = this.getUsageData();
                const today = this.getCurrentDate();
                const thisMonth = this.getCurrentMonth();

                // 일간 사용량 업데이트
                if (!data.dailyUsage[today]) {
                    data.dailyUsage[today] = 0;
                }
                data.dailyUsage[today] += tokensUsed;

                // 월간 사용량 업데이트
                if (!data.monthlyUsage[thisMonth]) {
                    data.monthlyUsage[thisMonth] = 0;
                }
                data.monthlyUsage[thisMonth] += tokensUsed;

                // 총 분석 횟수 증가
                data.totalAnalyses += 1;

                this.saveUsageData(data);
                this.updateDisplay();
            }

            getTodayUsage() {
                const data = this.getUsageData();
                const today = this.getCurrentDate();
                return data.dailyUsage[today] || 0;
            }

            getMonthlyUsage() {
                const data = this.getUsageData();
                const thisMonth = this.getCurrentMonth();
                return data.monthlyUsage[thisMonth] || 0;
            }

            getTotalAnalyses() {
                const data = this.getUsageData();
                return data.totalAnalyses || 0;
            }

            formatTokens(tokens) {
                if (tokens >= 1000000) {
                    return (tokens / 1000000).toFixed(1) + 'M 토큰';
                } else if (tokens >= 1000) {
                    return (tokens / 1000).toFixed(1) + 'K 토큰';
                } else {
                    return tokens + ' 토큰';
                }
            }

            updateDisplay() {
                const todayUsage = this.getTodayUsage();
                const monthlyUsage = this.getMonthlyUsage();
                const totalAnalyses = this.getTotalAnalyses();

                // DOM 업데이트
                const todayElement = document.getElementById('todayUsage');
                const monthlyElement = document.getElementById('monthlyUsage');
                const totalElement = document.getElementById('totalAnalyses');
                const percentElement = document.getElementById('usagePercent');
                const progressElement = document.getElementById('usageProgress');

                if (todayElement) todayElement.textContent = this.formatTokens(todayUsage);
                if (monthlyElement) monthlyElement.textContent = this.formatTokens(monthlyUsage);
                if (totalElement) totalElement.textContent = totalAnalyses + '회';

                // 월간 한도 대비 퍼센트 계산 (1,500 RPD = 약 45,000 토큰/월로 추정)
                const monthlyLimit = 45000;
                const usagePercent = Math.min((monthlyUsage / monthlyLimit) * 100, 100);
                
                if (percentElement) percentElement.textContent = usagePercent.toFixed(1) + '%';
                if (progressElement) {
                    progressElement.style.width = usagePercent + '%';
                    
                    // 사용량에 따른 색상 변경
                    if (usagePercent >= 90) {
                        progressElement.style.background = 'linear-gradient(90deg, var(--warning), var(--accent-error))';
                    } else if (usagePercent >= 70) {
                        progressElement.style.background = 'linear-gradient(90deg, var(--accent-warning), var(--warning))';
                    } else {
                        progressElement.style.background = 'linear-gradient(90deg, var(--success), var(--primary))';
                    }
                }
            }

            // 분석 실행 시 호출할 메서드
            onAnalysisComplete(estimatedTokens = 1000) {
                this.recordUsage(estimatedTokens);
                
                // 사용량 업데이트 애니메이션
                setTimeout(() => {
                    this.updateDisplay();
                }, 500);
            }
        }

        // Usage tracker 인스턴스 생성
        const usageTracker = new APIUsageTracker();

        // InvestmentAnalysisApp 클래스 수정하여 사용량 추적 연동
        const originalShowResults = InvestmentAnalysisApp.prototype.showResults;
        InvestmentAnalysisApp.prototype.showResults = function(result) {
            // 기존 결과 표시 로직 실행
            originalShowResults.call(this, result);
            
            // 사용량 추적 (보고서 길이에 따라 토큰 수 추정)
            const reportLength = result.investment_report ? result.investment_report.length : 1000;
            const estimatedTokens = Math.max(500, Math.min(2000, reportLength / 2)); // 대략적인 토큰 추정
            
            usageTracker.onAnalysisComplete(estimatedTokens);
        };

        // Navigation functionality
        class NavigationManager {
            constructor() {
                this.navItems = document.querySelectorAll('.nav-item');
                this.sections = document.querySelectorAll('.section-content');
                this.bindEvents();
            }

            bindEvents() {
                this.navItems.forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const sectionName = e.currentTarget.dataset.section;
                        if (sectionName) {
                            this.switchSection(sectionName);
                        }
                    });
                });
            }

            switchSection(sectionName) {
                // Update nav items
                this.navItems.forEach(item => item.classList.remove('active'));
                const activeNav = document.querySelector(`[data-section="${sectionName}"]`);
                if (activeNav) activeNav.classList.add('active');

                // Update sections
                this.sections.forEach(section => section.classList.remove('active'));
                const activeSection = document.getElementById(`${sectionName}-section`);
                if (activeSection) activeSection.classList.add('active');
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            new InvestmentAnalysisApp();
            new NavigationManager();
        });
    </script>
</body>
</html>